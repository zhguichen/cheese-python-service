# ğŸ“˜ AI ç»ƒä¸€ç»ƒæ—¥å¿—è®°å½•éœ€æ±‚æ–‡æ¡£ï¼ˆJSONL æ ¼å¼ï¼‰

## ä¸€ã€æ—¥å¿—ç›®æ ‡

AI ç»ƒä¸€ç»ƒæ¨¡å—çš„æ—¥å¿—ç”¨äºè¿½è¸ª **å‡ºé¢˜ â†’ ç­”é¢˜ â†’ åˆ¤é¢˜** çš„å®Œæ•´æµç¨‹ï¼Œ
ä»¥ä¾¿äºåæœŸè¿›è¡Œï¼š

* LLM é¢˜ç›®ç”Ÿæˆæ•ˆæœè¯„ä¼°
* ç”¨æˆ·ç­”é¢˜è¡Œä¸ºåˆ†æ
* æ¨¡å‹åˆ¤é¢˜å‡†ç¡®ç‡ä¸å“åº”å»¶è¿Ÿåˆ†æ
* ç»“æœå¯é‡ç°ä¸æº¯æº

æ—¥å¿—åªä»¥æ–‡ä»¶å½¢å¼å­˜å‚¨ï¼ˆJSON Linesï¼‰ï¼Œ**ä¸å…¥æ•°æ®åº“**ï¼Œå…·å¤‡é«˜å¯è¯»æ€§ä¸æœºå™¨å¯è§£ææ€§ã€‚

---

## äºŒã€æ–‡ä»¶ç»“æ„

æ¯ä½ç”¨æˆ·ç‹¬ç«‹ç›®å½•ï¼Œæ¯ä¸ªç»ƒä¹  session å¯¹åº”ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ã€‚sessionæ¥è‡ªAPIè¯·æ±‚ä¸­çš„sessionIdã€‚

```
logs/
  user_{user_id}/
    session_{session_id}.jsonl
```

* **user_id**ï¼šç”¨æˆ·å”¯ä¸€æ ‡è¯†
* **session_id**ï¼šä¸€æ¬¡ç»ƒä¹ çš„å”¯ä¸€æ ‡è¯†
* æ–‡ä»¶åç¼€å›ºå®šä¸º `.jsonl`
* æ¯è¡Œä¸€ä¸ª JSON å¯¹è±¡

---

## ä¸‰ã€æ–‡ä»¶å†…å®¹ç»“æ„

æ—¥å¿—æ–‡ä»¶åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š

1. **Meta ä¿¡æ¯è¡Œ**ï¼ˆç¬¬ 1 è¡Œï¼Œä»…å‡ºç°ä¸€æ¬¡ï¼‰
2. **äº‹ä»¶è®°å½•è¡Œ**ï¼ˆç¬¬ 2 è¡Œèµ·ï¼Œè‹¥å¹²æ¡ï¼‰

---

### ï¼ˆ1ï¼‰Meta ä¿¡æ¯è¡Œ

> ç”¨äºæè¿°å½“å‰ç»ƒä¹ çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä»…å†™ä¸€æ¬¡ã€‚

```json
{
  "meta": {
    "session_id": "session_20251029_001",
    "user_id": "user_123",
    "book_name": "Pythonå…¥é—¨",
    "book_introduction": "ä¸ºé›¶åŸºç¡€å­¦ä¹ è€…è®¾è®¡çš„Pythonå…¥é—¨è¯¾ç¨‹ã€‚",
    "section_id": "sec_abc123",
    "section_content": "åœ¨Pythonä¸­ï¼Œå˜é‡ç”¨äºå­˜å‚¨æ•°æ®ã€‚å˜é‡åå¯ä»¥ç”±å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ç»„æˆâ€¦â€¦",
    "start_time": "2025-10-29T18:00:00+08:00",
    "version": "v1.0.0"
  }
}
```

#### å­—æ®µè¯´æ˜

| å­—æ®µå               | ç±»å‹     | è¯´æ˜                 |
| ----------------- | ------ | ------------------ |
| session_id        | string | å½“å‰ç»ƒä¹ å”¯ä¸€æ ‡è¯†           |
| user_id           | string | ç”¨æˆ·æ ‡è¯†               |
| book_name         | string | ä¹¦å                 |
| book_introduction | string | ä¹¦ç±ç®€ä»‹               |
| section_id        | string | å°èŠ‚ ID              |
| section_content   | string | å°èŠ‚æ­£æ–‡ï¼ˆä½œä¸º LLM å‡ºé¢˜ä¸Šä¸‹æ–‡ï¼‰ |
| start_time        | string | Session å¼€å§‹æ—¶é—´       |
| version           | string | æ—¥å¿—æ ¼å¼ç‰ˆæœ¬å·            |

---

### ï¼ˆ2ï¼‰äº‹ä»¶è®°å½•è¡Œ

æ¯ä¸ªäº‹ä»¶ä¸ºä¸€è¡Œ JSONï¼ŒåŒ…å«ä»¥ä¸‹åŸºæœ¬å­—æ®µï¼š

```json
{
  "event_type": "generate",
  "timestamp": "2025-10-29T18:03:00+08:00",
  "data": { ... }
}
```

#### é€šç”¨å­—æ®µè¯´æ˜

| å­—æ®µå        | ç±»å‹     | è¯´æ˜                      |
| ---------- | ------ | ----------------------- |
| event_type | string | äº‹ä»¶ç±»å‹ï¼ˆè§ä¸‹è¡¨ï¼‰               |
| timestamp  | string | äº‹ä»¶æ—¶é—´æˆ³                   |
| data       | object | äº‹ä»¶æ•°æ®ä½“ï¼Œç»“æ„ä¾ event_type è€Œå®š |

---

## å››ã€äº‹ä»¶ç±»å‹å®šä¹‰

### 1ï¸âƒ£ å‡ºé¢˜äº‹ä»¶ï¼ˆ`event_type = "generate"`ï¼‰

è®°å½• LLM ç”Ÿæˆçš„é¢˜ç›®ä¿¡æ¯åŠæ¨¡å‹å…ƒæ•°æ®ã€‚

```json
{
  "event_type": "generate",
  "timestamp": "2025-10-29T18:03:00+08:00",
  "data": {
    "latency_ms": 3150,
    "questions": [
      {
        "question_id": "1",
        "type": "single_choice",
        "content": "Pythonä¸­ç”¨äºå®šä¹‰å‡½æ•°çš„å…³é”®å­—æ˜¯ï¼Ÿ"
      },
      {
        "question_id": "2",
        "type": "short_answer",
        "content": "è§£é‡ŠPythonçš„ç¼©è¿›è§„åˆ™ã€‚"
      }
    ]
  }
}
```

---

### 2ï¸âƒ£ ç”¨æˆ·ç­”é¢˜äº‹ä»¶ï¼ˆ`event_type = "answer"`ï¼‰

è®°å½•ç”¨æˆ·æäº¤çš„ç­”æ¡ˆã€‚

```json
{
  "event_type": "answer",
  "timestamp": "2025-10-29T18:07:11+08:00",
  "data": {
    "answers": [
      {"question_id": "1", "answer": "def"},
      {"question_id": "2", "answer": "é€šè¿‡ç¼©è¿›åŒºåˆ†ä»£ç å—"}
    ]
  }
}
```

---

### 3ï¸âƒ£ åˆ¤é¢˜äº‹ä»¶ï¼ˆ`event_type = "judge"`ï¼‰

è®°å½• LLM å¯¹ç”¨æˆ·ç­”æ¡ˆçš„åˆ¤å®šç»“æœä¸è§£æã€‚

```json
{
  "event_type": "judge",
  "timestamp": "2025-10-29T18:08:55+08:00",
  "data": {
    "latency_ms": 2500,
    "results": [
      {
        "question_id": "1",
        "is_correct": true,
        "parsing": "æ­£ç¡®ç­”æ¡ˆæ˜¯defï¼Œç”¨äºå®šä¹‰å‡½æ•°ã€‚"
      },
      {
        "question_id": "2",
        "is_correct": true,
        "parsing": "ç¼©è¿›ç”¨äºè¡¨ç¤ºä»£ç å—å±‚çº§ã€‚"
      }
    ]
  }
}
```

